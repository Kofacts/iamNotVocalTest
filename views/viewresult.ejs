<!DOCTYPE html>
<html>
<head lang="en">
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title>View result | I_AMVOCAL</title>
	<!-- all assets files --><link href="img/favicon.ico" rel="icon">
	<link rel="stylesheet" type="text/css" href="assets/materialize/materialize/css/materialize.css">
	<link rel="stylesheet" type="text/css" href="assets/custom/style.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/material-design-iconic-font/2.2.0/css/material-design-iconic-font.min.css"> 
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Montserrat:400,700">
</head>
<body style="background: #F5F5F5">
	<% include includes/navbar %>

	<section id="section_body" >
		<div id="background_section" style="height: 200px;">
			<div class="container valign-wrapper padd-20 font-big-light">
	  			<h4 class="light-b">Result for <% poll['name'] %> poll</h4>
			</div>
		</div>
		<div class="container" style="margin-top: -70px;">

			<div class="card horizontal" style="height:100%; margin-top: 20px; margin-bottom: 160px">
				<div class="card-stacked">
			        <div class="card-content aboutPoll">
			        	<span class="poll--indi-desc">Name of poll</span><br>
								<hr class="line-break">
								<br>
								<p class="poll--info" style="padding-top: 15px">
									<%- poll['name'] %>
								</p>
								<br>
								<span class="poll--indi-desc">About the poll</span><br>
								<hr class="line-break">
								<br>
								<p class="poll--info" style="padding-top: 15px; text-align: justify  !important; padding-right: 30px; margin-right: 0px;">
									<%- poll['description'] %>
								</p>
								<br>
								<span class="poll--indi-desc">Total number of participants</span><br>
								<hr class="line-break">
								<br>
								<p class="poll--info" style="padding-top: 15px; text-align: justify !important;">
									<%- poll['participants'].length %> participants
								</p>
								<br>

								<span class="poll--indi-desc">Total number of votes</span><br>
								<hr class="line-break">
								<br>
								<p class="poll--info" style="padding-top: 15px; text-align: justify !important;">
									<%- poll['participants'].length %> votes
								</p>
								<br>

								<div class="row">
									<div class="col s12 l3">
										<span class="poll--indi-desc">Start date</span><br>
										<hr class="line-break">
										<br>
										
										<p class="poll--info" style="padding-top: 15px">
											 <%- poll['startTime'] %>
										</p>		
									</div>

									<div class="col s12 l3">
										<span class="poll--indi-desc">End date</span><br>
										<hr class="line-break">
										<br>
										
										<p class="poll--info" style="padding-top: 15px">
											 <%- poll['endTime'] %>
										</p>		
									</div>

									<div class="col s12 l3">
										<span class="poll--indi-desc">Start time</span><br>
										<hr class="line-break">
										<br>
										
										<p class="poll--info" style="padding-top: 15px">
											 <%- poll['startAt'] %>
										</p>		
									</div>

									<div class="col s12 l3">
										<span class="poll--indi-desc">End time</span><br>
										<hr class="line-break">
										<br>
										
										<p class="poll--info" style="padding-top: 15px">
											 <%- poll['endAt'] %>
										</p>		
									</div>
								</div>
								<br>
								
								

								<div class="divider"></div>
								<span class="poll--indi-desc"><br>Stats/Graphical Analysis</span><br>
								<hr class="line-break">
								<br>

								<div class="row" style="width: 100% !important; margin-lef">
								    <div class="col s12" style="width: 100%">
								      <ul class="tabs">
								        <li class="tab col s6" style=""><a class="active" href="#test1"><i class="material-icons left tiny" style="padding-top: 20px">fingerprint</i>
								        <span class="hide-on-small-only">Individual Scores</span>
								        <span class="hide-on-med-and-up">Scores</span>
								        </a></li>
								        <li class="tab col s6"><a  href="#test2"><i class="material-icons left tiny" style="padding-top: 20px">insert_chart</i>
								        	<span class="hide-on-small-only">Graphical analysis</span>
								        <span class="hide-on-med-and-up">Graph</span>
								        </a></li>
								       
								      </ul>
								    </div>
								    <div id="test1" class="col s12">
								    	<br>
								    	<!-- indi score -->

								    	 <ul class="collapsible" style="width: 100% !important">
								    	 	<% for(var i=0; i< poll['contestants'].length; i++) { %>
											    <li>
											      <div class="collapsible-header"><i class="material-icons">assignment_ind</i><% poll['contestants'][i]['name'] %> </div>
											      <div class="collapsible-body part-content">
											      	<center>
											      		<span style="text-align: center; font-family: 'Montserrat'; font-size: 30px" class="center" >
											      		<%- poll['contestants'][i]['votes'] %> <br>
											      		Votes
											      		</span>
											      	</center>

											      </div>
											    </li>
										    <% } %>
										  </ul>
								    </div>
								    <div id="test2" class="col s12">
								    	<!-- charts -->
								    	<br>
								    	<canvas id="myChart" width="400" height="400"></canvas>
								    </div>
								   
								  </div>
						</div>
						<!-- end -->

						
			        </div>
			    </div>
			</div>

			</div>
		</div>

	</section>

	<!-- footer section -->
	<% include includes/footer %>

<script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="assets/materialize/materialize/js/materialize.js"></script>
<script type="text/javascript" src="assets/particlesjs/particles.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.js"></script>
<script type="text/javascript">
	particlesJS.load('particles-js', 'assets/custom/particles.json', function() {
	  console.log('callback - particles.js config loaded');
	});
</script>
<script type="text/javascript" src="assets/custom/style.js"></script>
<script type="text/javascript">
// function getRandomColor() {
//   var letters = '0123456789ABCDEF';
//   var color = '#';
//   for (var i = 0; i < 6; i++) {
//     color += letters[Math.floor(Math.random() * 16)];
//   }
//   return color;
// }
function getRandomColor() {
    var letters = 'ABCDE'.split('');
    var color = '#';
    for (var i=0; i<3; i++ ) {
        color += letters[Math.floor(Math.random() * letters.length)];
    }
    return color;
}
</script>
<script>
var ctx = document.getElementById("myChart").getContext('2d');

var participants = [];
var participantsScores = [];

<% for (var i = 0; i < poll['contestants'].length; i++){ %>
	participants.push(poll['contestants'][i]['name']);
	participantsScores.push(poll['contestants'][i]['votes']);
<% } %>
var myChart = new Chart(ctx, {
    type: 'bar',
    data: {
    	//using foreach to loop the names of participants as label -- 1
        labels: participants,
        datasets: [{
            label: '# of Votes',
            //using forloop to assign no of votes to labels
            data: participantsScores,
            backgroundColor: '#1b36ff',
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero:true
                }
            }]
        },
        responsive: true,
    }
});
</script>
</body>

</html>